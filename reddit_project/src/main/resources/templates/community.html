
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Community</title>
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
    <style>
        .header-profile {
        width: 172px;
    height: 54px;
    display: flex;
    padding-top: 3px;
}
.create-new-post-button{
    border-radius: 30px;
    width: 134px;
    height: 46px;
    margin-top: 10px;
    background-color: #7baae5;
}
.search-create-new-post-button{
    width: 781px;
    height: 86px;
    margin-bottom: 10px;
}
    </style>
</head>
<body>
<main>
    <header id="pageHeader">
        <div id="header-logo">
            <a href="/">
                <img th:src="@{/images/Reddit-logo.png}" alt="logo" class="header-img"/>
            </a>
        </div>
        <div id="home-nav">
            <img th:src="@{/images/home.png}" alt="home" class="header-img"/>
            <h4 class="header-text">Home</h4>
        </div>
        <div id="home-search">
            <input type="search" class="search-bar" placeholder="Search Reddit"/>
        </div>
        <div id="header-options">
            <a href="">
                <img th:src="@{/images/popular.png}" alt="home" class=".header-options-img"/>
            </a>

            <a href="">
                <img th:src="@{/images/notify.png}" alt="home"/>
            </a>

            <a href="">
                <img th:src="@{/images/message.png}" alt="home"/>
            </a>

            <a href="">
                <img th:src="@{/images/plus.png}" alt="home"/>
            </a>
        </div>
        <span sec:authorize="{isAuthenticated()}">
            <form th:action="@{/view-profile}">
            <input type="hidden" name="userId" th:value="${userData.userId}">
        <button style="border: none;">
        <div class="header-profile">
            <div id="header-profile-pic">
                <img th:src="@{/images/dp.png}" alt="picture"/>
            </div>

            <div id="header-profile-details">
                <div id="username-div">
                    <p class="profile-name"><span id="name" th:text="${userData.username}"></span></p>

                </div>

                <div id="karma-div">
                    <img th:src="@{/images/karma-star.png}" alt="star"/>
                    <p class="karma-point"><span th:text="${userData.karma} ?: 1"></span>
                        <span>karma</span>
                    </p>
                </div>

            </div>
        </div>
        </button>
        </form>
        </span>
    </header>

    <article id="mainArticle">
        <div id="community-header">
            <div id="community-color-banner"></div>
            <div id="community-data-banner">
                <div id="community-data">
                    <div id="community-banner-dp">
                        <div id="dp-img-div"><img th:src="@{/images/download.jpeg}" alt=""/></div>
                    </div>

                    <div id="community-banner-name">
                        <h1 th:text="'r/' + ${community.communityName}" ></h1>
                        <a href=""><p th:text="'r/' + ${community.communityName}"></p></a>
                    </div>
                    <span sec:authorize="{isAuthenticated()}">
                    <span th:if="${#authentication.getPrincipal().getUsername() != community.ownerId.username}">
                    <div id="community-banner-btn">
                        <form
                                th:action="@{${community.getCommunityMembers().contains(userData) ? '/remove-community':'/join-communtiy' }}"
                                method="post">
                            <!--                            <input type="hidden" name="userId" th:value="${user.userId}" />-->
                            <input type="hidden" name="communityName" th:value="${community.communityName}"/>
                            <input
                                    type="submit"
                                    th:value="${community.getCommunityMembers().contains(userData) ? 'joined' : 'join'}"
                                    class="community-join"
                            />
                        </form>
                    </div>
                    </span>
                    </span>
                    <span sec:authorize="{isAuthenticated()}">
                    <span th:if="${#authentication.getPrincipal().getUsername() == community.ownerId.username}">
                    <div id="community-banner-settings">
                        <form th:action="@{/view-settings}" method="get">
                            <input type="hidden" name="communityName" th:value="${community.communityName}" />
                            <input type="submit" value="Settings"/>
                        </form>
                    </div>
                    </span>
                    </span>
                </div>
            </div>
        </div>
        <div id="posts-main">
            <div id="posts-div">
                <!-- NEW POST UPLOAD DIV -->
                <span sec:authorize="{isAuthenticated()}">
                <span th:if="${#authentication.getPrincipal().getUsername() == community.ownerId.username || community.getCommunityMembers().contains(userData)}">
                <form th:action="@{/new-post}">
                    <input type="hidden" name="communityName" th:value="${community.communityName}">
                    <button class="search-create-new-post-button">
                <div id="upload-div">
                    <div id="dp-input-box">
                        <a href="">
                            <img th:src="@{/images/dp.png}" alt="" id="dp-input"/>
                        </a>
                    </div>
                    <div id="new-post-input">
                        <input
                                type="text"
                                id="post-input-box"
                                placeholder="Create Post"
                        />
                    </div>
                    <div id="new-post-media">
                        <a href="">
                            <img th:src="@{/images/image.png}" alt="image"/>
                        </a>
                        <a href="">
                            <img th:src="@{/images/link.png}" alt="link"/>
                        </a>
                    </div>
                </div>
                 </button>
                </form>
                </span>
                </span>
                <!-- NEW POST DIV END -->

                <!-- General Media post's start -->
                <div class="post">
                    <div class="post-vote-container">
                        <a href=""><img th:src="@{/images/upvote.png}" alt="" class="vote-img"/></a>
                        <p>34567</p>
                        <a href=""
                        ><img th:src="@{/images/downvote.png}" alt="" class="vote-img"
                        /></a>
                    </div>

                    <div class="post-data">
                        <div class="post-user-data">
                            <a href="" class="post-c-name"><h4>r/bollywood</h4></a>
                            <p>. posted by</p>
                            <a href="" class="post-c-name"><h4>u/radha_krishna</h4></a>
                            <p>on 2 days ago</p>
                        </div>

                        <div class="post-content">
                            <p>
                                Lorem ipsum dolor sit amet consectetur adipisicing elit.
                                Porro deleniti ipsa aliquid animi cumque magni fuga est
                                pariatur labore ab architecto, culpa id sequi numquam autem
                                distinctio inventore illo reiciendis.
                            </p>
                        </div>

                        <div class="post-media">
                            <div class="video-container" style="--aspect-ratio: 2 / 3">
                                <iframe th:src="@{/images/video.mp4}"></iframe>
                            </div>
                        </div>

                        <div class="post-options">
                            <a href="">
                                <div class="post-comments">
                                    <img th:src="@{/images/comments.png}" alt="" class="comments-img"/>
                                    <p>35 Comments</p>
                                </div>
                            </a>

                            <a href="">
                                <div class="post-share">
                                    <img th:src="@{/images/share.png}" alt="" class="share-img"/>
                                    <p>share</p>
                                </div>
                            </a>

                            <a href="">
                                <div class="post-save">
                                    <img th:src="@{/images/save.png}" alt="" class="save-img"/>
                                    <p>Save</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="post">
                    <div class="post-vote-container">
                        <a href=""><img th:src="@{/images/upvote.png}" alt="" class="vote-img"/></a>
                        <p>34567</p>
                        <a href=""
                        ><img th:src="@{/images/downvote.png}" alt="" class="vote-img"
                        /></a>
                    </div>

                    <div class="post-data">
                        <div class="post-user-data">
                            <a href="" class="post-c-name"><h4>r/bollywood</h4></a>
                            <p>. posted by</p>
                            <a href="" class="post-c-name"><h4>u/radha_krishna</h4></a>
                            <p>on 2 days ago</p>
                        </div>

                        <div class="post-content">
                            <p>
                                Lorem ipsum dolor sit amet consectetur adipisicing elit.
                                Porro deleniti ipsa aliquid animi cumque magni fuga est
                                pariatur labore ab architecto, culpa id sequi numquam autem
                                distinctio inventore illo reiciendis.
                            </p>
                        </div>

                        <div class="post-media">
                            <div class="video-container" style="--aspect-ratio: 2 / 3">
                                <iframe th:src="@{/images/video2.mp4}"></iframe>
                            </div>
                        </div>

                        <div class="post-options">
                            <a href="">
                                <div class="post-comments">
                                    <img th:src="@{/images/comments.png}" alt="" class="comments-img"/>
                                    <p>35 Comments</p>
                                </div>
                            </a>

                            <a href="">
                                <div class="post-share">
                                    <img th:src="@{/images/share.png}" alt="" class="share-img"/>
                                    <p>share</p>
                                </div>
                            </a>

                            <a href="">
                                <div class="post-save">
                                    <img th:src="@{/images/save.png}" alt="" class="save-img"/>
                                    <p>Save</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                <!-- General Media post's End -->
            </div>
            <!-- Posts nav div start -->
            <div id="posts-nav-div">
                <div id="div-about-community">
                    <div class="div-about-community-heading">
                        <h3>About Community</h3>
                    </div>

                    <div id="div-community-info">

                        <div th:if="${community.about == null}">
                            <p>No About!!!.Go to the Settings-> </p>
                            <!--              This subreddit is to discuss the current happenings in Taarak-->
                            <!--              Mehta Ka Ooltah Chashmah(TMKOC) and post memes and other stuff-->
                            <!--              about it.
                            -->
                        </div>
                        <p th:text="${community.about}"></p>
                    </div>

                    <div id="div-community-created">
                        <img th:src="@{/images/bday.png}" alt=""/>Created On
                        <span  th:text="${#dates.format(community.createdAt, 'dd-MMMM-YYYY')}"></span>
                    </div>
                    <div id="div-community-people">
                        <h4>Total Members :
                            <span th:text="${community.communityMembers != null ? community.communityMembers.size() + 1 : 1}" ></span></h4>
                    </div>
                    <span sec:authorize="{isAuthenticated()}">
                    <span th:if="${#authentication.getPrincipal().getUsername() == community.ownerId.username || community.getCommunityMembers().contains(userData)}">
                    <form th:action="@{/new-post}">
                        <input type="hidden" name="communityName" th:value="${community.communityName}">
                        <button class="create-new-post-button">

                        Create Post

                        </button>
                    </form>
                    </span>
                    </span>
                </div>

                <!-- Moderators List -->
                <span sec:authorize="{isAuthenticated()}">
                    <span th:if="${#authentication.getPrincipal().getUsername() == community.ownerId.username || community.getCommunityMembers().contains(userData)}">
                <div id="div-about-moderators">
                    <div class="div-about-community-heading">
                        <h3>Moderators</h3>
                    </div>

                    <div id="nav-contact-moderators">
                        <a href="" id="message-mod">Message Moderator </a>
                        <div id="mod-names">
                            <div th:each="item, moderator : ${community.communityModerators}" th:if="${moderator.count} &lt;= 4">
                                <div>
                                    <form th:action="@{/upload}" method="get">
                                        <a th:href="@{/}"><span th:text=" 'u/' + ${item.username}"></span></a>
                                    </form>
                                </div>
                            </div>

                        </div>
<!--                        <div >-->
<!--                            <a href="" class="mod-name-link all-mod">View All Mods</a>-->
<!--                        </div>-->
                        <div id="all-mods">
                            <a th:href="@{/users/r(communityName=${community.communityName})}">View Members</a>
                        </div>
                    </div>

                </div>
                        </span>
                    </span>
            </div>
        </div>
    </article>

    <nav id="mainNav"></nav>
</main>

</body>
</html>